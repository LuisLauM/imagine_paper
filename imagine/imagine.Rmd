---
title: "imagine: IMAGing engINE, Tools for Application of Image Filters to Data Matrices"
author:
  - name: Wencheng Lau-Medrano
    affiliation: Instituto del Mar del Perú
    address:
    - Esquina Gamarra y General Valle s/n, Chucuito, Callao-Perú
    - +51 (1)208-8650
    email:  llau@imarpe.gob.pe
abstract: >
  El campo del procesamiento de imágenes abarca un amplio rango de operaciones que permiten el análisis, síntesis y modificación de la información contenida en una imagen, entendida esta como una matriz de datos. Las salidas de dichas operaciones pueden ser otras imágenes (matrices) o parámetros obtenidos de ellas. Dentro de este campo, resaltan las operaciones de Convolución y median-filters. En el presente trabajo, se hace una introducción al paquete imagine, cuyas funciones permiten la ejecución sobre matrices de datos (imágenes) de las dos principales operaciones antes mencionadas. A modo de ejemplo, se mostrarán aplicaciones sobre 1)ecogramas, aplicadas mediante el paquete oXim (Lau-Medrano, 2016), y 2) detección de frentes de TSM en la costa de Perú.
preamble: >
  % Any extra latex you need in the preamble
bibliography: RJreferences.bib
output: rticles::rjournal_article
fig_caption: yes

---

```{r functions, include=FALSE}
fig = local({
  i = 0
  ref = list()
  list(
    cap = function(refName, text) {
      i <<- i + 1
      ref[[refName]] <<- i
      if(output == "word") lab = paste("Figure ", i, ": ", text, sep="")
      if(output != "word") lab = paste(text, sep="")
      return(lab)
    },
    ref = function(refName) {
      return(ref[[refName]])
    })
})

```

```{r results='hide', message=FALSE, warning=FALSE, echo=FALSE}
require(imagine)
output = "pdf"
```

# Introduction
El procesamiento de imágenes involucra la aplicación de operaciones del procesamiento de señales sobre imágenes. Una imagen puede ser definida como una función bidimensional donde x y y son coordenadas y la amplitud de f es llamada intensidad o nivel de grises de la imagen en cualquier punto (Gonzalez & Woods, 2008). De este modo, una imagen puede ser entendida como una matriz de valores numéricos en los que cada color y su intensidad en cada pixel es una representación de los valores en cada celda de la matriz. A partir de este enfoque numérico, es posible comprender la aplicación de operaciones numéricas sobre imágenes a fin de hallar analizar, sintetizar, hallar patrones, calcular parámetros o modificar la naturaleza de los valores contenidos en una imagen.

Dentro de las principales operaciones en el procesamiento de imágenes, destacan las de median-filter y convoluciones. La operación de median-filter permite realizar suavizamientos sobre dos dimensiones mediante la extracción de la mediana de los vecindarios de cada celda, mientras que en las convoluciones es posible realizar una ponderación sobre los valores los vecindarios mediante el uso de matrices pequelñas llamadas kernels. Los detalles de cada operación se explican mejor abajo; sin embargo, es importante resaltar que su aplicación es computacionalmente pesada pues requiere de la implementación de bucles anidados, los cuales son particularmente lentos en R. Por este motivo, imagine implementa el uso de algoritmos en C++ (llamados engines) los cuales permiten ejecutar convoluciones sucesivas sobre una misma matriz en tiempos muy poco tiempo, respecto a que si los bucles se hubieran implementado en lenguaje R. Así mismo, imagine brinda a los usuarios una interfaz sencilla, con argumentos intuitivos, similares a los usados en paquetes clásicos de graficación de matrices de datos.

En el presente trabajo, se presenta la aplicación de algoritmos de convolución y median-filter para la limpieza de ruido en ecogramas y la detección de frentes de TSM en el Ecosistema de Afloramiento Peruano. Para el primero, se mostrará la ejecución del paquete oXim (Lau-Medrano, 2016) el cual tiene como objetivo la estimación de la profundidad de la oxiclina (capa de rápido descenso de la concentración de oxígeno en la columna de agua). En el segundo ejemplo, se muestra la extracción de gradientes a partir de mapas de TSM y su relación con frentes térmicos. Así mismo, se explpica su potencialidad para la detección de otros patrones ambientales tales como remolinos a mesoescala (eddies).

#Convolutions and 2D median-filters, how they works?


As Gonzalez & Woods (XXXX) says "an image may be defined as a two-dimensional function f(x, y), where x and y are spatial (plane) coordinates and the amplitude of f at any pair of coordinates (x, y) is called the intensity or gray level of the image at that point".
